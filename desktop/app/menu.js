const electron=require("electron"),Menu=electron.Menu;exports.createProjectMenu=function(){const e=[{label:"File",submenu:[{label:"New Project",accelerator:"CmdOrCtrl+N",click(){createProject()}},{label:"Save Project",accelerator:"CmdOrCtrl+S",click(){mainWindow.webContents.send("save_project")}},{label:"Save Project As",accelerator:"CmdOrCtrl+S+Shift",click(){if(null==loadedproject)return;const e=require("electron").dialog,o=require("electron").app,r=e.showSaveDialog({options:{title:"Create Project",defaultPath:o.getPath("home")}}),t=require("path");var a=projects.createProjectDir(t.basename(r),r);require("fs-extra").copy(loadedproject.project.loadPath+"/"+loadedproject.project.project.name+".xml",a.project.loadPath+"/"+a.project.project.name+".xml",function(o){o?e.showErrorBox("Could not save project",o):loadProject("load_project",a)})}},{label:"Load Project",accelerator:"CmdOrCtrl+O",click(){loadProjectDialog()}},{type:"separator"},{label:"Load in Arduino",accelerator:"CmdOrCtrl+L",click(){const e=require("child_process").spawn,o=arg.project.loadPath+"/"+arg.project.project.name+"/"+arg.project.project.name+".ino";"darwin"!=process.platform?e("C:\\Program Files (x86)\\Arduino\\arduino.exe",[o]):e("/Applications/Arduino.app/Contents/MacOS/Arduino",[o])}},{label:"Upload to Arduino",accelerator:"CmdOrCtrl+U",click(){const e=require("child_process").spawn,o=arg.project.loadPath+"/"+arg.project.project.name+"/"+arg.project.project.name+".ino";var r=null,t="";(r="darwin"!=process.platform?e("C:\\Program Files (x86)\\Arduino\\arduino_debug.exe",["--upload",o]):e("/Applications/Arduino.app/Contents/MacOS/Arduino",["--upload",o])).stdout.on("data",e=>{t+=e,console.log(`stdout: ${e}`)}),r.stderr.on("data",e=>{t+=e,console.log(`stderr: ${e}`)}),r.on("close",e=>{0==e?electron.dialog.showMessageBox({type:"info",message:"Program Uploaded To Arduino",buttons:["OK"]}):electron.dialog.showErrorBox("Error Uploading To Arduino",t),console.log(`child process exited with code ${e}`)})}}]},{label:"View",submenu:[{label:"Toggle Developer Tools",accelerator:"darwin"===process.platform?"Alt+Command+I":"Ctrl+Shift+I",click(e,o){o&&o.webContents.toggleDevTools({mode:"detach"})}},{label:"View Code",accelerator:"CmdOrCtrl+I",click(e,o){o.webContents.send("show_code")}}]}];if("darwin"===process.platform){const o=electron.app.getName();e.unshift({label:o,submenu:[{role:"about"},{type:"separator"},{role:"services",submenu:[]},{type:"separator"},{role:"hide"},{role:"hideothers"},{role:"unhide"},{type:"separator"},{role:"quit"}]})}const o=Menu.buildFromTemplate(e);Menu.setApplicationMenu(o)};